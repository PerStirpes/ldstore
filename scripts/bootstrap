set -e

if [ "$(uname -s)" != "Darwin" ]; then
  echo "Not an OSX machine, exiting!"
  exit 1
fi

cd "$(dirname "${BASH_SOURCE[0]}")/.."
# shellcheck disable=SC1091
. ./script/lib/email-prompt
email_prompt

gitconfig=$HOME/.gitconfig
if [[ ! -f $gitconfig ]]; then
  echo "==> Configuring ~/.gitconfig"
  template="$(cat etc/gitconfig-tmpl)"
  eval "echo \"${template}\" > $gitconfig"
else
  echo "==> Git config ($gitconfig) already exists, skipping"
fi

echo "==> Checking for XCode command line tools, follow the GUI prompts if any..."
xcode=$(xcode-select -p > /dev/null)
if [[ ! $xcode ]]; then
  echo "XCode already installed."
else
  xcode-select --install
fi
